<html>
<head>
    <title>Hero Combat</title>
    <link rel='stylesheet' type='text/css' href='./css/bootstrap.min.css'/>
    <link rel="import" href="./webcomponents/darkmane-speedchart/speed-chart.html" />

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script type="text/javascript" src="https://apis.google.com/js/client.js?onload=handleClientLoad"></script>
    <script src='./js/jquery.min.js'></script>
    <script src='./js/bootstrap.min.js'></script>
    <script src='./js/jquery-gdrive.js'></script>
    <script src='./js/herocombat.js'></script>
    <script src="bower_components/webcomponentsjs/webcomponents-lite.min.js"></script>

    <script type="text/javascript">
        function getFileList(request, callback) {
            request.execute(function (resp) {
                var nextPageToken = resp.nextPageToken;
                if (nextPageToken) {
                    var req = drive_api.files.list({q: query, pageToken: nextPageToken});
                    getFileList(req, callback);
                }
                callback(resp.items);
            });
        }

        $(document).ready(function () {
            $("#startCombat").click(startCombat);

            var query = 'fileExtension="hdc"';
            var drive_api = document.getElementById('drive_api');
            drive_api.addEventListener('google-api-load', function (event) {
                var gdriveApi = document.getElementById('gdriveInput');
                gdriveApi.addEventListener('click', function (event) {

                    var req = drive_api.files.list({q: query});
                    getFileList(req, function (data) {

                        for (var i = 0; data.length; i++) {
                            var datum = data[i];
                            var elem = document.getElementById('gdrive_list');
                            var li = document.createElement('li');

                            li.append(document.createTextNode(datum.title));
                            li.addEventListener('click', loadFileFromWeb(datum.webContentLink));
                            elem.append(li);
                        }
                    });
                });

            });
        });

    </script>

    <link rel='import' href='./components/combatchart.html'/>

</head>
<body>
<google-client-loader id="drive_api" name="drive" version="v2"></google-client-loader>
<nav class="navbar nav-header hidden-print hidden-xs hidden-sm affix-top">
    <div class="container-fluid">
        <a class="navbar-brand" href="#">Hero Combat</a>
        <ul class="nav navbar-nav">

            <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button">Load<span
                    class="caret"></span></a>
                <ul class="dropdown-menu" role="menu">
                    <li><input id="loadlocalfile" type="file" multiple="true" name="localInput"
                               onchange="loadLocalFile('loadlocalfile')"/>
                    </li>
                    <li>
                        <button id="gdriveInput" type="file" name="localInput">GDrive
                        </button>
                    </li>
                </ul>
            </li>

        </ul>
    </div>
</nav>


<div class="container-fluid">

    <div class="row">
        <div class="col-md-6 col-sm-12 col-xs-12">

            <table class="table table-bordered table-condensed">
                <thead id="combatheader">
                <tr>
                    <th class="col-md-4 col-sm-8 col-xs-8">Name</th>
                    <th class="col-offset-md-4 col-offset-sm-8 col-offset-xs-8 col-md-1 col-sm-2 col-xs-2">SPD</th>
                    <th class="col-offset-md-5 col-offset-sm-10 col-offset-xs-10 col-md-1 col-sm-2 col-xs-2">DEX</th>
                </tr>
                </thead>
                <tbody id="combatsheet">
                </tbody>
            </table>
        </div>
        <speed-chart></speed-chart>

    </div>
    <div class="row">
        <button id="startCombat" onclick="startCombat">Start</button>
    </div>
</div>
</body>
</html>
